@model TourismManagementSystem.Models.ViewModels.TouristDashboardVm
@{
    ViewBag.Title = "My Dashboard";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<!-- Header -->
<div class="container-fluid bg-breadcrumb">
    <div class="container text-center py-5" style="max-width: 900px;">
        <h3 class="text-white display-3 mb-4">My Dashboard</h3>
        <ol class="breadcrumb justify-content-center mb-0">
            <li class="breadcrumb-item"><a href="@Url.Action("Index","Home")">Home</a></li>
            <li class="breadcrumb-item active text-white">Dashboard</li>
        </ol>
    </div>
</div>

<div class="container py-4">
    @if (TempData["Success"] != null)
    {<div class="alert alert-success">@TempData["Success"]</div>}
    @if (TempData["Info"] != null)
    {<div class="alert alert-info">@TempData["Info"]</div>}

    <h4 class="mt-2 mb-3">Upcoming Bookings</h4>
    @if (Model.Upcoming == null || !Model.Upcoming.Any())
    {
        <div class="alert alert-light">No upcoming bookings yet.</div>
    }
    else
    {
        <div class="table-responsive">
            <table class="table table-striped table-sm align-middle">
                <thead>
                    <tr>
                        <th>Tour</th>
                        <th>Start</th>
                        <th>End</th>
                        <th>People</th>
                        <th>Status</th>
                        <th>Payment</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var b in Model.Upcoming)
                    {
                        <tr>
                            <td>@b.PackageTitle</td>
                            <td>@(b.StartDate?.ToString("yyyy-MM-dd") ?? "-")</td>
                            <td>@(b.EndDate?.ToString("yyyy-MM-dd")   ?? "-")</td>

                            <td>@b.Participants</td>
                            <td>@b.Status</td>
                            <td>@b.PaymentStatus</td>
                            <td>
                                <a class="btn btn-sm btn-outline-primary"
                                   href="@Url.Action("BookingDetails","Tourist", new { id = b.BookingId })">
                                    Details
                                </a>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    }

    <h4 class="mt-5 mb-3">Past Trips</h4>
    @if (Model.Past == null || !Model.Past.Any())
    {
        <div class="alert alert-light">No past trips yet.</div>
    }
    else
    {
        <div class="table-responsive">
            <table class="table table-striped table-sm align-middle">
                <thead>
                    <tr>
                        <th>Tour</th>
                        <th>Start</th>
                        <th>End</th>
                        <th>People</th>
                        <th>Status</th>
                        <th>Feedback</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var b in Model.Past)
                    {
                        <tr>
                            <td>@b.PackageTitle</td>
                            <td>@(b.StartDate?.ToString("yyyy-MM-dd") ?? "-")</td>
                            <td>@(b.EndDate?.ToString("yyyy-MM-dd")   ?? "-")</td>

                            <td>@b.Participants</td>
                            <td>@b.Status</td>
                            <td>
                                @if (b.CanLeaveFeedback)
                                {
                                    @*<a class="btn btn-sm btn-primary"
                                       href="@Url.Action("Create","Feedback", new { bookingId = b.BookingId })">
                                        Leave Feedback
                                    </a>*@

                                    <a class="btn btn-sm btn-primary"
                                       href="@Url.Action("CreateReview","Tourist", new { bookingId = b.BookingId })">
                                        Leave Feedback
                                    </a>
                                }
                                else
                                {
                                    <span class="text-muted">—</span>
                                }
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    }
</div>
