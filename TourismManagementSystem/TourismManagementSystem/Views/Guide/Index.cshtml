@model IEnumerable<TourismManagementSystem.Models.ViewModels.GuideListItemVm>
@{
    ViewBag.Title = "Our Travel Guides";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<!-- Header -->
<div class="container-fluid bg-breadcrumb">
    <div class="container text-center py-5" style="max-width: 900px;">
        <h3 class="text-white display-3 mb-4">Our Travel Guides</h3>
        <ol class="breadcrumb justify-content-center mb-0">
            <li class="breadcrumb-item"><a href="@Url.Action("Index", "Home")">Home</a></li>
            <li class="breadcrumb-item"><a href="#">Pages</a></li>
            <li class="breadcrumb-item active text-white">Guides</li>
        </ol>
    </div>
</div>

<!-- Guides -->
<div class="container-fluid guide py-5">
    <div class="container py-5">
        <div class="mx-auto text-center mb-4" style="max-width: 900px;">
            <h5 class="section-title px-3">Travel Guide</h5>
            <h1 class="mb-0">Meet Our Guides</h1>
        </div>

        <!-- Search -->
        <form class="row g-2 mb-4" method="get" action="@Url.Action("Index","Guide")">
            <div class="col-md-6">
                <input class="form-control" type="text" name="q" value="@Request["q"]" placeholder="Search guides by name" />
            </div>
            <div class="col-md-3">
                <button class="btn btn-primary w-100">Search</button>
            </div>
        </form>

        @if (Model == null || !Model.Any())
        {
            <div class="alert alert-info">No guides are available yet. Please check back later.</div>
        }
        else
        {
            <div class="row g-4">
                @foreach (var g in Model)
                {
                    <div class="col-md-6 col-lg-3">
                        <div class="guide-item h-100 d-flex flex-column">
                            <div class="guide-img">
                                <div class="guide-img-efects">
                                    <img src="@(!string.IsNullOrEmpty(g.PhotoPath) ? Url.Content(g.PhotoPath) : Url.Content("~/Content/img/guide-placeholder.jpg"))"
                                         class="img-fluid w-100 rounded-top" alt="@g.FullName" />
                                </div>
                                <div class="guide-icon rounded-pill p-2">
                                    <a class="btn btn-square btn-primary rounded-circle mx-1" href="#"><i class="fab fa-facebook-f"></i></a>
                                    <a class="btn btn-square btn-primary rounded-circle mx-1" href="#"><i class="fab fa-twitter"></i></a>
                                    <a class="btn btn-square btn-primary rounded-circle mx-1" href="#"><i class="fab fa-instagram"></i></a>
                                    <a class="btn btn-square btn-primary rounded-circle mx-1" href="#"><i class="fab fa-linkedin-in"></i></a>
                                </div>
                            </div>

                            <div class="guide-title text-center rounded-bottom p-4 flex-grow-1 d-flex flex-column justify-content-between">
                                <div class="guide-title-inner">
                                    <h4 class="mt-3">@g.FullName</h4>

                                    @if (!string.IsNullOrWhiteSpace(g.Bio))
                                    {
                                        <p class="mb-2 small text-muted">
                                            @((g.Bio.Length > 90) ? g.Bio.Substring(0, 90) + "..." : g.Bio)
                                        </p>
                                    }

                                    <div class="mb-2">
                                        <span class="badge bg-primary">Tours: @g.TotalTours</span>
                                        <span class="badge bg-warning text-dark ms-1">
                                            Rating: @(g.AvgRating.HasValue ? g.AvgRating.Value.ToString("0.0") : "—")
                                        </span>
                                    </div>

                                    @if (!string.IsNullOrWhiteSpace(g.Phone))
                                    {
                                        <div class="small"><i class="fa fa-phone me-1"></i>@g.Phone</div>
                                    }
                                </div>

                                <div class="mt-3">
                                    <a class="btn btn-sm btn-outline-primary"
                                       href="@Url.Action("Index","Package", new { guideId = g.ProfileId })">
                                        View Tours
                                    </a>
                                    <a class="btn btn-sm btn-primary ms-2"
                                       href="@Url.Action("Contact","Home", new { subject = "Guide:" + g.FullName })">
                                        Contact
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                }
            </div>
        }
    </div>
</div>
